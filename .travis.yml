# Use container based trusty environment to make nodejs native extensions
# work without extra package installs.
sudo: false
dist: trusty

os:
  - linux
  - osx

language: node_js
node_js:
  - 6

addons:
  apt:
    packages:
      # Needed for electron-builder to process .icns icon image files
      - icnsutils
      - graphicsmagick
      - xz-utils

before_script:
  - npm install bower
  - ./node_modules/.bin/bower install

script:
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then npm run pack:mac   ; fi
  - if [[ "$TRAVIS_OS_NAME" != "osx" ]]; then npm run pack:linux ; fi

deploy:
  provider: releases
  api_key:
    secure: xMS0WBatNJz+XSquXeNeYzLMNf4avk5eBk6O8VHUQ3fQG37bHVbjDaqd/PrvIOgO2tlJdhayIfJYsFPkP5ahVMi7qj4HpM1GU5Lq6jbEvUUyYBGlfhILhS9u5KXMjwvoAJZ0TaOyz3dhJMWX/EOXIMxiaX7fAtLTvFkPgC74dwY9r7vvHnRG20Zc52zEMXBn1OVkmHqxCK7zGfEWrarYD3RImWA6BBl852ncipOY5l7y0yCeRokULzIM9MwQgKNAhZO2ijexZLNdlPk3DDuw+SLWPxSjYoHcadASPp2iBTkV9cKbKs/IRXEdkSFgiV9HFIo4TnJQ7V7sAH8NjwVBJaPxBi2TBEjKWY786fOMu2CJxSkQ4XywicI/5p1SS3Yd60tUvGed38AJWZr0N8f559hLZNHsqehF/8V0r+KBbCkCndOAjdnGrypuJXRpRUsQVw1qD5B5mrvAom/OBaGI/6lIRZkO8GJe1JUvToXV/VvIh00OcgnHVddX1BKnvYVvisI7MadkkukqQbj5WfwHAzZzAQ1wdrD3g5gZjiXO81f1ZGBvrz4le2LBy/amMr+aP5EFuoZwWk4lC9ME5M8ZZR/bcbw6L0UJV+Zj10VNtJFeOPJzbnYC3CojWQkHrqH3F7H+GWBy0pl9Ms98sPItrW2YAL+lMnaya4XuqOmdiKw=
  file_glob: true
  file:
    - "dist-builder/*.AppImage"
    - "dist-builder/*.dmg"
    - "dist-builder/latest.yml"
    - "dist-builder/latest-mac.json"
  skip_cleanup: true
  on:
    tags: true
